# Стандарты, методики разработки
## Общие положения

Базовые требования к разработке определены в "Системе стандартов и методик разработки конфигураций для платформы 1С:Предприятие".
Любые отклонения от них требуют согласования с руководителем разработки.

> Подробнее по ссылке [1С:Предприятие 8. Система стандартов и методик разработки конфигураций](https://its.1c.ru/db/v8std)

Изменение объектов конфигураций, входящих в состав "Библиотеки стандартных подсистем" (далее *БСП*), а также встраивание её компонентов должно выполняться согласно документации к соответствующей версии библиотеки.

> Подробнее по ссылке [1С:Библиотека стандартных подсистем](https://its.1c.kz/section/dev/doc_bsp)

Каждая конфигурация должна иметь свой утвержденный идентификатор - краткое представление на английском языке. Идентификатор конфигурации должен указываться преимущественно в верхнем регистре.
Принятые обозначения:

* `ERP` - для конфигурации "1С:ERP WE (World Edition)";
* `CORP` - для конфигурации "1С:Управление холдингом для Казахстана";
* `HRMkz` - для конфигурации "1С:Зарплата и управление персоналом для Казахстана, ред. 3.1".

## Создание и изменение объектов

Имена добавляемых объектов метаданных, реквизитов, процедур и функций, а также комментарии к фрагментам кода конфигурации должны начинаться с префикса, идентифицирующего компанию-разработчика:

* `ax` - для компании "Акселлект Казахстан", выполняющей внедрение проекта 1С:ERP;
* `sc` - для локальной разработки "Solidcore Resources".

Префикс компании-разработчика указывается на английском языке, в нижнем регистре. Исключение составляет использование префикса в имени файла или тексте комментария.

Пример:

```bsl
Перем sc_ДиалогРаботыСКаталогом;
...
Функция ax_ЗаполнитьИменаРеквизитов()
```

Префикс компании-разработчика не указывается в поле `Синоним` объектов метаданных, их реквизитов.

Новые объекты конфигураций и прочие связанные компоненты должны содержать идентификатор задачи из системы управления задачами, выбранной для проекта разработки. Не допускается использование нескольких систем управления задачами в рамках одного и того же проекта.
Формат значения идентификатора:

* Длина не менее 5 символов;
* Начинается со знака номера (`#`) без пробелов;
* Содержит лидирующие нули при необходимости;
* Содержит порядковый номер задачи.

Пример: `#00281`

Исключения составляют ситуации, когда платформа 1С:Предприятие или операционная система запрещает использование специальных символов. В подобных ситуациях идентификатор задачи указывается без знака номера в начале.

Идентификатор задачи не указывается в поле `Синоним` объектов конфигураций и прочих связанных компонентов.

Порядок указания идентификатора:

| Тип объекта | Где указывается идентификатор |
| --- | --- |
| Объект метаданных конфигурации: документ, подсистема, регистр сведений и т.п. | Поле `Комментарий` |
| Реквизит объекта метаданных: реквизит документа, измерение регистра и т.п. | Поле `Комментарий` |
| Комментарий к процедуре, функции, общему модулю, фрагменту кода и т.д. | В начале текста |
| Расширение конфигурации для исправления ошибок (hotfix) | Имя файла, имя расширения и поле `Префикс` |
| Внешняя обработка, подключаемая с помощью подсистемы "Дополнительные отчеты и обработки" | Имя файла, имя объекта и поле `Информация` в функции `СведенияОВнешнейОбработке()` |
| Внешний отчёт, подключаемый с помощью подсистемы "Дополнительные отчеты и обработки" | Имя файла, имя объекта и поле `Информация` в функции `СведенияОВнешнейОбработке()` |
| Проект в системе "1С:Шина" | Имя и описание проекта и его приложений |
| Правила обмена данными, разработанные в конфигурации "1С:Конвертация данных 2.0" | Имя файла, поля `Наименование` и `Описание` |
| Запись изменений в репозиторий конфигурации (хранилище) | Поле `Метка` |

Пример:

```bsl
Функция СведенияОВнешнейОбработке() Экспорт
    ПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке("3.1.7.422");
    ПараметрыРегистрации.Вид = ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительныйОтчет();
    ПараметрыРегистрации.БезопасныйРежим = Истина;
    ПараметрыРегистрации.Информация = "#00147 Текст описания обработки";
```

Пример:

```bsl
// #00052 Текст комментария
Процедура ax_ЗапретитьИзменениеДокумента()
```

## Сценарии модификации конфигураций

Выбор способа модификации конфигурации должен основываться на принципе минимизации изменений в основной конфигурации.

### Базовые сценарии добавления объектов

| Вид объекта | Где вносятся изменения |
| --- | --- |
| Бизнес-процесс, все виды регистров, константа, документ, перечисление, план видов характеристик, план счетов, справочник | Основная конфигурация |
| Реквизит (измерение, ресурс) для существующего объекта метаданных | Основная конфигурация |
| Объекты, которые критичны для выполнения бизнес-логики либо должны содержать ссылки на множество объектов конфигурации | Основная конфигурация |
| Обработка, отчёт | Расширение или в виде дополнительной обработки (отчёта) согласно БСП |
| Все остальные объекты метаданных | Расширение |

### Редактирование реквизитов объектов

Изменение свойств и реквизитов типовых объектов, включая способ реализации, должно быть согласовано с руководителем разработки.

### Редактирование форм

Внесение изменений в типовые формы должно выполняться программно, с использованием общего модуля. Имя модуля должно быть задано в формате: "МодификацияКонфигурации" + идентификатор конфигурации.
Исключения должны быть согласованы с руководителем разработки.

Пример: `МодификацияКонфигурацииCORP`

### Редактирование макетов

Доработка макетов табличных документов типовой конфигурации должна выполняться в расширении со способом `Замещать`.

### Редактирование ролей

Добавление ролей осуществляется как в основной конфигурации, так и в расширении в следующем порядке:

* Если роль предназначена для объектов, существующих только в расширении, то она должна добавляться в расширении;
* В остальных случаях допускается создание роли в основной конфигурации.

Изменение типовых ролей конфигурации должно выполняться через расширение и по согласованию с руководителем разработки.

### Внешние компоненты

Использование платформозависимых API (к примеру, COM) при разработке не допускается. Исключения должны быть согласованы с руководителем разработки.

### Комментарии

При написания комментария к коду необходимо руководствоваться принципом разумной достаточности. Комментарий должен не пересказывать фрагмент кода, а пояснять его.

Текст комментария должен быть эмоционально сдержанными и не содержать выражений, не относящихся к функциональности конфигурации.

Требования по оформлению комментария:

* Комментарий должен располагаться перед комментируемым фрагментом кода;
* Между символами комментария `//` и его текстом должен быть пробел;
* Каждая строка комментария не должна превышать 120 символов;
* Текст многострочного комментария должен быть выровнен по левой границе фрагмента кода, к которому он относится.

### Структура модуля

Каждый функциональный, смысловой блок кода должен быть выделен в отдельную область (директива `#Область`). Допускается использование вложенных областей. Общая структура модуля должна быть оформлена согласно *Системе стандартов и методик разработки*.

### Точечная модификация кода

Для точечной модификации кода расширяемого модуля должны использоваться директив препроцессора `#Вставка`, `#КонецВставки` и `#Удаление`, `#КонецУдаления` для указания фрагментов текста, которые необходимо добавить в расширяемый модуль и, соответственно, удалить из него.

Метод, для которого выполняется модификация, должен быть отмечен аннотацией `&ИзменениеИКонтроль`

> Подробнее данный способ описан в главе "Расширение конфигурации" из документации к версии платформы 1С:Предприятие на сайте 1С:ИТС

Для точечной модификации кода в основной конфигурации должен быть указан комментарий: до и после фрагмента кода. Текст комментария должен содержать идентификатор компании-разработчика, идентификатор задачи и описание вносимых изменений.

Пример:

```bsl
// SC #00394 Текст комментария
...
// SC #00394
```

## Расширения конфигураций

### Общая информация

Каждое расширение конфигурации должно иметь одно из следующих целевых назначений:

* Адаптация, дополнение функционала основной конфигурации;
* Исправление критических ошибок типовой конфигурации поставщика;

Объекты расширений для адаптации, дополнения функционала должны быть сгруппирован в подсистемы в зависимости от функционального направления, для которого вносятся изменения.
Изменение перечня подсистем должно быть согласовано с руководителем разработки.

Список доступных подсистем:

* Бюджетирование;
* Казначейство;
* МСФО и консолидация;
* Регламентированный учет;
* Системная интеграция;
* Управление закупками;
* Управление запасами;
* Управление инвестиционными проектами;
* Управление НСИ;
* Управление продажами;
* Управление производством;
* Управление ремонтами;
* Учет баланса металлов;
* Учет затрат и расчет себестоимости.

### Создание расширения

Правила заполнения метаданных расширения:

* **Имя файла** - должно начинаться с идентификатора конфигурации. Далее должно быть указано представление в зависимости от цели создания расширения:
  * Для адаптации, дополнения - сокращенное название Компании.

    Пример: `ERP_Solidcore.cfe`
  * Для исправления ошибки типовой конфигурации - обозначение `hotfix` и идентификатор задачи.

    Пример: `CORP_hotfix_00192.cfe`
* **Имя конфигурации** - должно совпадать с именем файла расширения;
* **Синоним** - заполняется обязательно и содержит представление расширения для пользователя, исключая служебные идентификаторы, префиксы и т.п.;

  Пример: `Solidcore (ERP WE)` или `Исправление 00192`
* **Префикс** - должен формироваться в зависимости от цели создания расширения и оканчиваться символом подчеркивания:
  * Для адаптации, дополнения - идентификатор конфигурации.

    Пример: `ERP_`
  * Для исправления ошибки типовой конфигурации - идентификатор конфигурации и идентификатор задачи.

    Пример: `CORP_00192_`

## Дополнительные обработки, отчёты

Дополнительные (внешние) обработки, отчёты должны разрабатываться согласно методическим материалам фирмы "1С":

* Управляемое приложение - согласно документации к подсистеме "Дополнительные отчеты и обработки" из БСП и при наличии подсистемы в составе конфигурации;
* Обычное приложение - согласно документации по ссылке [Внешние обработки, печатные формы, обработки по заполнению табличных частей](https://its.1c.ru/db/metod8dev/content/4259/hdoc)

Подключение обработок (отчётов) в управляемом приложении должен осуществляться в безопасном режиме (`ПараметрыРегистрации.БезопасныйРежим = Истина`) с указанием перечня необходимых разрешений. Отключение использования безопасного режима допустимо только в отдельных, обоснованных случаях.

Для обработок с типом `Заполнение объекта` и `Создание связанных объектов` должна выполняться проверка прав доступа пользователей на их использование.

Пример:

```bsl
Если НЕ Пользователи.РолиДоступны("ДобавлениеИзменениеКурсовВалют") Тогда
    Отказ = Истина;
КонецЕсли;
```

Имя файла дополнительной обработки, отчёта должно начинаться с идентификатора конфигурации, порядкового номера задачи и обозначения вида объекта, разделенных символом подчеркивания.

Возможные обозначения объектов:

* `ПФ` - для печатных форм;
* `Отчет` - для дополнительных отчётов;
* `Обработка` - для остальных видов дополнительных обработок.

Пример: `CORP_00015_ПФ_Отпуск_ПодробныйРасчетНачислений.epf`

Представление дополнительной обработки, отчёта (поле `Синоним`) не должно содержать служебных идентификаторов, префиксов и т.п.